{% extends 'ProjectBody/Body.html' %}
{% load static %}
{% block contenid %}

    <!--<div id="TableList"></div>
<a href="javascript:prevPage()" id="btn_prev">Prev</a>&nbsp;
<a href="javascript:nextPage()" id="btn_next">Next</a><br>
page: <span id="page"></span>-->
    <div class="card">
        <!-- Card header -->
        <div class="card-header">
            <h5 class="mb-0">Productos</h5>
            <p class="text-sm mb-0">
                Listado de productos
            </p>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="row">


                    {% for art in articulo %}
                        <div class="col-3">
                            <div class="card bordecard">
                                <div class="card-header">
                                    <a href="/media/{{ art.image }}" data-lightbox="mygallery" data-title="{{ art.nombre }}">
                                        <img  src="/media/{{ art.image }}" title="ver imagen" class="center" alt="Responsive image"  style="width:300px; height:250px; object-fit: cover;" >
                                    </a>
                                </div>

                                <div class="card-body pt-2">
                                    <span class="text-gradient text-primary text-uppercase text-xs font-weight-bold my-2">{{ art.nombre }}</span>
                                    <a class="card-title h5 d-block text-darker">
                                        Marca: {{ art.m_marca.nombre }}
                                    </a>
                                    <a class="card-title h5 d-block text-darker">
                                        Categoría: {{ art.m_tipocategoria.descripcion }}
                                    </a>

                                    <div class="author align-items-center">
                                        <div class="row">
                                            <div class="col-6">
                                                <span>Precio: </span>   ${{ art.precio}}
                                            </div>
                                            <div class="col-12">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input precioo" type="checkbox" data-json='{"descripcion":"{{ art.m_marca.nombre }} {{ art.m_tipocategoria.descripcion }} {{ art.nombre }}","id":"{{ art.id }}","precio":"{{ art.precio }}"}' id="flexSwitchCheckDefault">
                                                    <label class="form-check-label" for="flexSwitchCheckDefault">Generar Pedido</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="name ps-3">

                                            <div class="stats">
                                                <small></small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br> <br>
                    {% endfor %}

                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block jscript %}
    <script>
      var _subtotal_ =0;
        var _total_ =0;
        var lista_clientescuentas =[];
      $('.precioo').click(function(){
      var data = $(this).data('json'),descripcion = data.descripcion, id = data.id;
      var precio =data.precio;

            if($(this).prop("checked") == true){
                precio=precio.replace(',', '.').replace('$', '');
                 alert(precio)
                var item = new Object();
                item.id =id;
                item.precio = precio;
                item.descripcion=descripcion;
                item.cantidad =1;
                item.total=precio;
                /*if (!existe(item)) {
                    lista_clientescuentas.push(item);
                    actualizar();
                    presentar();
                }*/
            }
            else if($(this).prop("checked") == false){
                for (var i in lista_clientescuentas) {
                    if (lista_clientescuentas[i].id == id) {
                        lista_clientescuentas.splice(i,1);
                        actualizar();
                        presentar();
                    }
                }
            }
      });

        /*swal("¡Bien!", "Has hecho clic en el botón :)", "success");*/



        /*
        swal({
            title: "Venta realizada",
            confirmButtonText: "Aceptar",
        });*/
        $(function () {
            {% if messages %}
            {% endif %}
            {% for message in messages %}
                swal('Información!', '{{ message }}');
            {% endfor %}
            $('#contenedor').on('click', 'a[rel="action"]', function () {
                var data = $(this).data('json'),
                    action = data.action,
                    id = data.id;
                if (action == 'elim') {
                    var desc = $(this).parents('tr').children('td').eq(5).html();
                    $('#descripcion').html(desc);
                    $('#frmEliminar #id').val(id);

                    swal({
                        title: "Estas segura/o?",
                        text: "Una vez eliminado, no podrá recuperar este archivo!\n Nombre:"+desc,
                        icon: "warning",
                        buttons: true,
                        dangerMode: true,
                    })
                        .then((willDelete) => {
                            if (willDelete) {

                                window.location = '{{ ruta }}?action=' + action + '&id=' + id;

                            } else {
                                swal("Tu archivo está a salvo!");
                                return
                            }
                        });

                }else {
                    window.location = '{{ ruta }}?action=' + action + '&id=' + id;
                }
            });
        });

         var data = [
                {% for c in articulo %}
                    [{number: '{{  c.nombre  }}'},{'descripcion': '{{c.descripcion}}'}, {'precio':'${{ c.precio }}'}],
                {% endfor %}
        ];
         console.log(data)
        var obj = [
{ number: "Number 1"},
{ number: "Number 2"},
{ number: "Number 3"},
{ number: "Number 4"},
{ number: "Number 5"},
{ number: "Number 6"},
{ number: "Number 7"},
{ number: "Number 8"},
{ number: "Number 9"},
{ number: "Number 10"},
{ number: "Number 11"},
{ number: "Number 12"},
{ number: "Number 13"},
{ number: "Number 14"},
{ number: "Number 15"}
];
var current_page = 1;
var obj_per_page = 3;
function totNumPages()
{
    return Math.ceil(data.length / obj_per_page);
}

function prevPage()
{
    if (current_page > 1) {
        current_page--;
        change(current_page);
    }
}
function nextPage()
{
    if (current_page < totNumPages()) {
        current_page++;
        change(current_page);
    }
}
function change(page)
{
    var btn_next = document.getElementById("btn_next");
    var btn_prev = document.getElementById("btn_prev");
    var listing_table = document.getElementById("TableList");
    var page_span = document.getElementById("page");
    if (page < 1) page = 1;
    if (page > totNumPages()) page = totNumPages();
    listing_table.innerHTML = "";
    for (var i = (page-1) * obj_per_page; i <= (page * obj_per_page); i++) {
        listing_table.innerHTML += data[i].number + "<br>";
    }
    page_span.innerHTML = page;
    if (page == 1) {
        btn_prev.style.visibility = "hidden";
    } else {
        btn_prev.style.visibility = "visible";
    }
    if (page == totNumPages()) {
        btn_next.style.visibility = "hidden";
    } else {
        btn_next.style.visibility = "visible";
    }
}
window.onload = function() {
    change(1);
};
    </script>

{% endblock %}
